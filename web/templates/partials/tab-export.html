<!-- Reports Section -->
<h2 class="section-heading">Research Reports</h2>
<p class="hint-text">Generate structured reports from your research data. AI-enhanced reports use Claude to write narratives from your data.</p>
<div id="reportTemplates" class="report-template-row"></div>
<div id="reportGenForm" class="report-gen-form hidden"></div>
<div id="reportViewer" class="report-viewer hidden"></div>
<div id="reportList"></div>

<h2 class="section-heading">Quick Export</h2>
<div class="export-options">
    <div class="export-card">
        <h3>JSON</h3>
        <p>Full structured data for programmatic use</p>
        <a id="exportJson" href="/api/export/json" class="btn">Download JSON</a>
    </div>
    <div class="export-card">
        <h3>Markdown</h3>
        <p>LLM-optimized taxonomy for Claude / FigJam</p>
        <a id="exportMd" href="/api/export/md" class="btn">Download Markdown</a>
    </div>
    <div class="export-card">
        <h3>CSV</h3>
        <p>Spreadsheet-compatible format</p>
        <a id="exportCsv" href="/api/export/csv" class="btn">Download CSV</a>
    </div>
    <div class="export-card">
        <h3>Excel (.xlsx)</h3>
        <p>Formatted workbook with sheets per category</p>
        <button class="btn" onclick="exportXlsx()">Download Excel</button>
    </div>
    <div class="export-card">
        <h3>PDF Report</h3>
        <p>Professional PDF with charts and data tables</p>
        <button class="btn" onclick="exportFullPdf()">Download PDF</button>
    </div>
    <div class="export-card">
        <h3>PDF (Full Report)</h3>
        <p>Detailed taxonomy report with categories and company table</p>
        <button class="btn" onclick="exportProjectPdfFromTab()">Download Report PDF</button>
    </div>
    <div class="export-card">
        <h3>Excel (Styled)</h3>
        <p>Styled workbook with formatted headers and data</p>
        <button class="btn" onclick="exportProjectExcelFromTab()">Download Styled Excel</button>
    </div>
    <div class="export-card">
        <h3>Word (.docx)</h3>
        <p>Editable Word document with categories and companies</p>
        <button class="btn" onclick="exportProjectWordFromTab()">Download Word</button>
    </div>
    <div class="export-card">
        <h3>ZIP Bundle</h3>
        <p>All formats bundled: JSON, CSV, and more in one download</p>
        <button class="btn" onclick="exportProjectZipFromTab()">Download ZIP</button>
    </div>
</div>

<h2 class="section-heading">Share Project</h2>
<div class="share-section">
    <p class="hint-text">Generate a read-only share link for external stakeholders.</p>
    <div class="share-controls">
        <input type="text" id="shareLinkLabel" aria-label="Share link label" placeholder="Link label (e.g. 'For investors')">
        <button class="primary-btn" onclick="createShareLink()">Generate Link</button>
    </div>
    <div id="shareTokensList"></div>
</div>

<h2 class="section-heading">Notification Settings</h2>
<div class="notification-settings">
    <p class="hint-text">Configure alerts for project events.</p>
    <div class="notif-field">
        <label for="slackWebhook">Slack Webhook URL</label>
        <div class="flex-gap-xs">
            <input type="url" id="slackWebhook" placeholder="https://hooks.slack.com/services/...">
            <button class="btn" onclick="testSlack()">Test</button>
        </div>
    </div>
    <div class="notif-checkboxes">
        <label><input type="checkbox" id="notifBatchComplete" checked> Notify on batch complete</label>
        <label><input type="checkbox" id="notifTaxonomyChange" checked> Notify on taxonomy changes</label>
        <label><input type="checkbox" id="notifNewCompany"> Notify on new companies</label>
    </div>
    <button class="primary-btn" onclick="saveNotifPrefs()">Save Preferences</button>
    <div id="notifSaveResult" class="hidden"></div>
</div>

<h2 class="section-heading">Import CSV</h2>
<div class="import-section">
    <p class="hint-text">Upload a CSV file with columns: name, url, what, target, products, funding, geography, tam, tags, etc.</p>
    <form id="csvImportForm" onsubmit="importCsv(event)">
        <input type="file" id="csvFile" accept=".csv" required aria-label="CSV file to import">
        <button type="submit" class="primary-btn">Import</button>
    </form>
    <div id="importResult" class="hidden"></div>
</div>

<h2 class="section-heading">Trash</h2>
<p class="hint-text">Deleted companies can be restored or permanently removed.</p>
<button class="btn" onclick="loadTrash()">View Trash</button>
<div id="trashList" class="hidden"></div>

<h2 class="section-heading">Duplicates</h2>
<p class="hint-text">Find potential duplicate companies by URL.</p>
<button class="btn" onclick="findDuplicates()">Scan for Duplicates</button>
<div id="duplicatesList" class="hidden"></div>

<h2 class="section-heading">Activity Log</h2>
<p class="hint-text">Recent project activity and changes.</p>
<button class="btn" onclick="loadActivity()">Load Activity</button>
<div id="activityFeed" class="hidden"></div>
